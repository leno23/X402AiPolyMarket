# X402AiPolyMarket æ•°æ®åº“è®¾è®¡æ–‡æ¡£

## ğŸ“Š æ•°æ®åº“é€‰å‹

### ä¸»æ•°æ®åº“: MySQL 8.0
- **ç”¨é€”**: å­˜å‚¨ä¸šåŠ¡æ ¸å¿ƒæ•°æ®
- **ç‰¹ç‚¹**: ACIDäº‹åŠ¡æ”¯æŒã€æˆç†Ÿç¨³å®š
- **å­—ç¬¦é›†**: utf8mb4
- **æ’åºè§„åˆ™**: utf8mb4_unicode_ci

### ç¼“å­˜æ•°æ®åº“: Redis 6.0+
- **ç”¨é€”**: ç¼“å­˜çƒ­ç‚¹æ•°æ®ã€å®æ—¶ä»·æ ¼ã€æ’è¡Œæ¦œ
- **ç‰¹ç‚¹**: é«˜æ€§èƒ½ã€æ”¯æŒå¤šç§æ•°æ®ç»“æ„

---

## ğŸ—‚ï¸ æ•°æ®è¡¨è®¾è®¡

### 1. ç”¨æˆ·è¡¨ (users)

```sql
CREATE TABLE `users` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ç”¨æˆ·ID',
  `wallet_address` VARCHAR(42) NOT NULL COMMENT 'é’±åŒ…åœ°å€',
  `username` VARCHAR(50) DEFAULT NULL COMMENT 'ç”¨æˆ·å',
  `avatar_url` VARCHAR(255) DEFAULT NULL COMMENT 'å¤´åƒURL',
  `email` VARCHAR(100) DEFAULT NULL COMMENT 'é‚®ç®±',
  `bio` TEXT DEFAULT NULL COMMENT 'ä¸ªäººç®€ä»‹',
  
  `total_trades` INT UNSIGNED DEFAULT 0 COMMENT 'æ€»äº¤æ˜“æ¬¡æ•°',
  `total_volume` DECIMAL(20,8) DEFAULT 0 COMMENT 'æ€»äº¤æ˜“é‡',
  `total_profit` DECIMAL(20,8) DEFAULT 0 COMMENT 'æ€»æ”¶ç›Š',
  `win_count` INT UNSIGNED DEFAULT 0 COMMENT 'èƒœåˆ©æ¬¡æ•°',
  `lose_count` INT UNSIGNED DEFAULT 0 COMMENT 'å¤±è´¥æ¬¡æ•°',
  
  `status` TINYINT UNSIGNED DEFAULT 0 COMMENT 'çŠ¶æ€: 0-æ­£å¸¸ 1-ç¦ç”¨',
  `last_login_at` TIMESTAMP NULL DEFAULT NULL COMMENT 'æœ€åç™»å½•æ—¶é—´',
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_wallet_address` (`wallet_address`),
  KEY `idx_username` (`username`),
  KEY `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ç”¨æˆ·è¡¨';
```

---

### 2. å¸‚åœºè¡¨ (markets)

```sql
CREATE TABLE `markets` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'å¸‚åœºID',
  `question` TEXT NOT NULL COMMENT 'å¸‚åœºé—®é¢˜',
  `description` TEXT DEFAULT NULL COMMENT 'è¯¦ç»†æè¿°',
  `category` VARCHAR(50) NOT NULL COMMENT 'åˆ†ç±»: CRYPTO, TECH, STOCKS, POLITICS, SPORTS, SCIENCE',
  
  `creator_address` VARCHAR(42) NOT NULL COMMENT 'åˆ›å»ºè€…åœ°å€',
  `contract_address` VARCHAR(42) DEFAULT NULL COMMENT 'æ™ºèƒ½åˆçº¦åœ°å€',
  
  -- ä»·æ ¼ä¿¡æ¯
  `yes_price` DECIMAL(10,2) DEFAULT 50.00 COMMENT 'YESä»·æ ¼(cents)',
  `no_price` DECIMAL(10,2) DEFAULT 50.00 COMMENT 'NOä»·æ ¼(cents)',
  `yes_shares` DECIMAL(20,8) DEFAULT 0 COMMENT 'YESæ€»ä»½é¢',
  `no_shares` DECIMAL(20,8) DEFAULT 0 COMMENT 'NOæ€»ä»½é¢',
  
  -- ç»Ÿè®¡ä¿¡æ¯
  `total_volume` DECIMAL(20,8) DEFAULT 0 COMMENT 'æ€»äº¤æ˜“é‡',
  `total_liquidity` DECIMAL(20,8) DEFAULT 0 COMMENT 'æ€»æµåŠ¨æ€§',
  `participant_count` INT UNSIGNED DEFAULT 0 COMMENT 'å‚ä¸äººæ•°',
  `total_yes_volume` DECIMAL(20,8) DEFAULT 0 COMMENT 'YESæ€»äº¤æ˜“é‡',
  `total_no_volume` DECIMAL(20,8) DEFAULT 0 COMMENT 'NOæ€»äº¤æ˜“é‡',
  
  -- æ—¶é—´ä¿¡æ¯
  `start_time` TIMESTAMP NOT NULL COMMENT 'å¼€å§‹æ—¶é—´',
  `end_time` TIMESTAMP NOT NULL COMMENT 'ç»“æŸæ—¶é—´',
  `settlement_time` TIMESTAMP NULL DEFAULT NULL COMMENT 'ç»“ç®—æ—¶é—´',
  
  -- çŠ¶æ€
  `status` TINYINT UNSIGNED DEFAULT 0 COMMENT 'çŠ¶æ€: 0-å¾…å¼€å§‹ 1-è¿›è¡Œä¸­ 2-å·²ç»“æŸ 3-å·²ç»“ç®— 4-å·²å–æ¶ˆ',
  `result` TINYINT DEFAULT NULL COMMENT 'ç»“æœ: NULL-æœªç»“ç®— 0-NO 1-YES',
  
  -- æ ‡ç­¾
  `is_hot` BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦çƒ­é—¨',
  `is_featured` BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦ç²¾é€‰',
  `tags` JSON DEFAULT NULL COMMENT 'æ ‡ç­¾æ•°ç»„',
  
  -- å®¡æ ¸
  `audit_status` TINYINT UNSIGNED DEFAULT 0 COMMENT 'å®¡æ ¸çŠ¶æ€: 0-å¾…å®¡æ ¸ 1-å·²é€šè¿‡ 2-å·²æ‹’ç»',
  `audit_reason` TEXT DEFAULT NULL COMMENT 'å®¡æ ¸åŸå› ',
  `audited_at` TIMESTAMP NULL DEFAULT NULL COMMENT 'å®¡æ ¸æ—¶é—´',
  
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  
  PRIMARY KEY (`id`),
  KEY `idx_category` (`category`),
  KEY `idx_status` (`status`),
  KEY `idx_creator` (`creator_address`),
  KEY `idx_end_time` (`end_time`),
  KEY `idx_is_hot` (`is_hot`),
  KEY `idx_created_at` (`created_at`),
  KEY `idx_audit_status` (`audit_status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å¸‚åœºè¡¨';
```

---

### 3. è®¢å•è¡¨ (orders)

```sql
CREATE TABLE `orders` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'è®¢å•ID',
  `market_id` BIGINT UNSIGNED NOT NULL COMMENT 'å¸‚åœºID',
  `user_address` VARCHAR(42) NOT NULL COMMENT 'ç”¨æˆ·åœ°å€',
  
  `order_type` TINYINT UNSIGNED NOT NULL COMMENT 'è®¢å•ç±»å‹: 0-ä¹°å…¥ 1-å–å‡º',
  `position` TINYINT UNSIGNED NOT NULL COMMENT 'ä»“ä½: 0-NO 1-YES',
  
  `amount` DECIMAL(20,8) NOT NULL COMMENT 'æ•°é‡',
  `price` DECIMAL(10,2) NOT NULL COMMENT 'ä»·æ ¼(cents)',
  `total_value` DECIMAL(20,8) NOT NULL COMMENT 'æ€»ä»·å€¼',
  `fee` DECIMAL(20,8) DEFAULT 0 COMMENT 'æ‰‹ç»­è´¹',
  
  `filled_amount` DECIMAL(20,8) DEFAULT 0 COMMENT 'å·²æˆäº¤æ•°é‡',
  `avg_filled_price` DECIMAL(10,2) DEFAULT 0 COMMENT 'å¹³å‡æˆäº¤ä»·',
  
  `status` TINYINT UNSIGNED DEFAULT 0 COMMENT 'çŠ¶æ€: 0-å¾…æˆäº¤ 1-éƒ¨åˆ†æˆäº¤ 2-å®Œå…¨æˆäº¤ 3-å·²å–æ¶ˆ',
  
  `tx_hash` VARCHAR(66) DEFAULT NULL COMMENT 'äº¤æ˜“å“ˆå¸Œ',
  `block_number` BIGINT UNSIGNED DEFAULT NULL COMMENT 'åŒºå—å·',
  
  `cancelled_at` TIMESTAMP NULL DEFAULT NULL COMMENT 'å–æ¶ˆæ—¶é—´',
  `completed_at` TIMESTAMP NULL DEFAULT NULL COMMENT 'å®Œæˆæ—¶é—´',
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  
  PRIMARY KEY (`id`),
  KEY `idx_market_id` (`market_id`),
  KEY `idx_user_address` (`user_address`),
  KEY `idx_status` (`status`),
  KEY `idx_created_at` (`created_at`),
  KEY `idx_tx_hash` (`tx_hash`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='è®¢å•è¡¨';
```

---

### 4. äº¤æ˜“è®°å½•è¡¨ (trades)

```sql
CREATE TABLE `trades` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'äº¤æ˜“ID',
  `market_id` BIGINT UNSIGNED NOT NULL COMMENT 'å¸‚åœºID',
  `buy_order_id` BIGINT UNSIGNED NOT NULL COMMENT 'ä¹°å•ID',
  `sell_order_id` BIGINT UNSIGNED NOT NULL COMMENT 'å–å•ID',
  
  `buyer_address` VARCHAR(42) NOT NULL COMMENT 'ä¹°æ–¹åœ°å€',
  `seller_address` VARCHAR(42) NOT NULL COMMENT 'å–æ–¹åœ°å€',
  
  `position` TINYINT UNSIGNED NOT NULL COMMENT 'ä»“ä½: 0-NO 1-YES',
  `amount` DECIMAL(20,8) NOT NULL COMMENT 'æˆäº¤æ•°é‡',
  `price` DECIMAL(10,2) NOT NULL COMMENT 'æˆäº¤ä»·æ ¼',
  `total_value` DECIMAL(20,8) NOT NULL COMMENT 'æˆäº¤æ€»é¢',
  
  `buyer_fee` DECIMAL(20,8) DEFAULT 0 COMMENT 'ä¹°æ–¹æ‰‹ç»­è´¹',
  `seller_fee` DECIMAL(20,8) DEFAULT 0 COMMENT 'å–æ–¹æ‰‹ç»­è´¹',
  
  `tx_hash` VARCHAR(66) DEFAULT NULL COMMENT 'äº¤æ˜“å“ˆå¸Œ',
  `block_number` BIGINT UNSIGNED DEFAULT NULL COMMENT 'åŒºå—å·',
  
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  
  PRIMARY KEY (`id`),
  KEY `idx_market_id` (`market_id`),
  KEY `idx_buyer` (`buyer_address`),
  KEY `idx_seller` (`seller_address`),
  KEY `idx_created_at` (`created_at`),
  KEY `idx_tx_hash` (`tx_hash`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='äº¤æ˜“è®°å½•è¡¨';
```

---

### 5. æŒä»“è¡¨ (positions)

```sql
CREATE TABLE `positions` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'æŒä»“ID',
  `user_address` VARCHAR(42) NOT NULL COMMENT 'ç”¨æˆ·åœ°å€',
  `market_id` BIGINT UNSIGNED NOT NULL COMMENT 'å¸‚åœºID',

  `position` TINYINT UNSIGNED NOT NULL COMMENT 'ä»“ä½: 0-NO 1-YES',
  `shares` DECIMAL(20,8) NOT NULL DEFAULT 0 COMMENT 'æŒæœ‰ä»½é¢',
  `avg_price` DECIMAL(10,2) NOT NULL DEFAULT 0 COMMENT 'å¹³å‡æˆæœ¬ä»·',
  `total_cost` DECIMAL(20,8) NOT NULL DEFAULT 0 COMMENT 'æ€»æˆæœ¬',

  `current_value` DECIMAL(20,8) DEFAULT 0 COMMENT 'å½“å‰ä»·å€¼',
  `unrealized_pnl` DECIMAL(20,8) DEFAULT 0 COMMENT 'æœªå®ç°ç›ˆäº',
  `realized_pnl` DECIMAL(20,8) DEFAULT 0 COMMENT 'å·²å®ç°ç›ˆäº',

  `is_settled` BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦å·²ç»“ç®—',
  `settlement_value` DECIMAL(20,8) DEFAULT 0 COMMENT 'ç»“ç®—ä»·å€¼',

  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',

  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_market_position` (`user_address`, `market_id`, `position`),
  KEY `idx_user_address` (`user_address`),
  KEY `idx_market_id` (`market_id`),
  KEY `idx_is_settled` (`is_settled`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æŒä»“è¡¨';
```

---

### 6. AIé¢„æµ‹è¡¨ (ai_predictions)

```sql
CREATE TABLE `ai_predictions` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'é¢„æµ‹ID',
  `market_id` BIGINT UNSIGNED NOT NULL COMMENT 'å¸‚åœºID',

  `prediction_value` DECIMAL(5,2) NOT NULL COMMENT 'é¢„æµ‹å€¼(0-100)',
  `confidence` DECIMAL(5,2) NOT NULL COMMENT 'ç½®ä¿¡åº¦(0-100)',
  `suggests` TINYINT UNSIGNED NOT NULL COMMENT 'å»ºè®®: 0-NO 1-YES',

  `model_version` VARCHAR(50) NOT NULL COMMENT 'æ¨¡å‹ç‰ˆæœ¬',
  `model_name` VARCHAR(100) DEFAULT NULL COMMENT 'æ¨¡å‹åç§°',

  -- åˆ†ææ•°æ®
  `sentiment_score` DECIMAL(5,4) DEFAULT NULL COMMENT 'æƒ…ç»ªåˆ†æ•°',
  `trend_score` DECIMAL(5,4) DEFAULT NULL COMMENT 'è¶‹åŠ¿åˆ†æ•°',
  `volume_indicator` DECIMAL(5,4) DEFAULT NULL COMMENT 'äº¤æ˜“é‡æŒ‡æ ‡',

  `analysis_data` JSON DEFAULT NULL COMMENT 'AIåˆ†æè¯¦ç»†æ•°æ®',
  `key_factors` JSON DEFAULT NULL COMMENT 'å…³é”®å› ç´ æ•°ç»„',
  `risk_factors` JSON DEFAULT NULL COMMENT 'é£é™©å› ç´ æ•°ç»„',

  `is_latest` BOOLEAN DEFAULT TRUE COMMENT 'æ˜¯å¦æœ€æ–°é¢„æµ‹',

  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',

  PRIMARY KEY (`id`),
  KEY `idx_market_id` (`market_id`),
  KEY `idx_is_latest` (`is_latest`),
  KEY `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='AIé¢„æµ‹è¡¨';
```

---

### 7. é’±åŒ…ä½™é¢è¡¨ (wallet_balances)

```sql
CREATE TABLE `wallet_balances` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `user_address` VARCHAR(42) NOT NULL COMMENT 'ç”¨æˆ·åœ°å€',

  `usdc_balance` DECIMAL(20,8) DEFAULT 0 COMMENT 'USDCä½™é¢',
  `token_balance` DECIMAL(20,8) DEFAULT 0 COMMENT 'å¹³å°ä»£å¸ä½™é¢',
  `frozen_balance` DECIMAL(20,8) DEFAULT 0 COMMENT 'å†»ç»“ä½™é¢',

  `total_deposit` DECIMAL(20,8) DEFAULT 0 COMMENT 'ç´¯è®¡å……å€¼',
  `total_withdraw` DECIMAL(20,8) DEFAULT 0 COMMENT 'ç´¯è®¡æç°',

  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',

  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_address` (`user_address`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='é’±åŒ…ä½™é¢è¡¨';
```

---

### 8. é’±åŒ…äº¤æ˜“æµæ°´è¡¨ (wallet_transactions)

```sql
CREATE TABLE `wallet_transactions` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'æµæ°´ID',
  `user_address` VARCHAR(42) NOT NULL COMMENT 'ç”¨æˆ·åœ°å€',

  `tx_type` TINYINT UNSIGNED NOT NULL COMMENT 'äº¤æ˜“ç±»å‹: 0-å……å€¼ 1-æç° 2-äº¤æ˜“ 3-å¥–åŠ± 4-æ‰‹ç»­è´¹ 5-ç»“ç®—',
  `amount` DECIMAL(20,8) NOT NULL COMMENT 'é‡‘é¢',
  `currency` VARCHAR(10) NOT NULL COMMENT 'å¸ç§: USDC, TOKEN',

  `balance_before` DECIMAL(20,8) NOT NULL COMMENT 'äº¤æ˜“å‰ä½™é¢',
  `balance_after` DECIMAL(20,8) NOT NULL COMMENT 'äº¤æ˜“åä½™é¢',

  `related_type` VARCHAR(50) DEFAULT NULL COMMENT 'å…³è”ç±»å‹: order, market, settlement',
  `related_id` BIGINT UNSIGNED DEFAULT NULL COMMENT 'å…³è”ID',

  `tx_hash` VARCHAR(66) DEFAULT NULL COMMENT 'åŒºå—é“¾äº¤æ˜“å“ˆå¸Œ',
  `block_number` BIGINT UNSIGNED DEFAULT NULL COMMENT 'åŒºå—å·',

  `status` TINYINT UNSIGNED DEFAULT 1 COMMENT 'çŠ¶æ€: 0-å¾…å¤„ç† 1-æˆåŠŸ 2-å¤±è´¥',
  `remark` TEXT DEFAULT NULL COMMENT 'å¤‡æ³¨',

  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',

  PRIMARY KEY (`id`),
  KEY `idx_user_address` (`user_address`),
  KEY `idx_tx_type` (`tx_type`),
  KEY `idx_created_at` (`created_at`),
  KEY `idx_tx_hash` (`tx_hash`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='é’±åŒ…äº¤æ˜“æµæ°´è¡¨';
```

---

### 9. ç»“ç®—è¡¨ (settlements)

```sql
CREATE TABLE `settlements` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ç»“ç®—ID',
  `market_id` BIGINT UNSIGNED NOT NULL COMMENT 'å¸‚åœºID',

  `result` TINYINT UNSIGNED NOT NULL COMMENT 'ç»“æœ: 0-NO 1-YES',

  `total_pool` DECIMAL(20,8) NOT NULL COMMENT 'æ€»å¥–æ± ',
  `winner_pool` DECIMAL(20,8) NOT NULL COMMENT 'è·èƒœæ–¹å¥–æ± ',
  `loser_pool` DECIMAL(20,8) NOT NULL COMMENT 'å¤±è´¥æ–¹å¥–æ± ',

  `settlement_ratio` DECIMAL(10,6) NOT NULL COMMENT 'ç»“ç®—æ¯”ä¾‹',
  `platform_fee` DECIMAL(20,8) DEFAULT 0 COMMENT 'å¹³å°æ‰‹ç»­è´¹',
  `platform_fee_rate` DECIMAL(5,4) DEFAULT 0.02 COMMENT 'å¹³å°è´¹ç‡',

  `winner_count` INT UNSIGNED DEFAULT 0 COMMENT 'è·èƒœäººæ•°',
  `total_payout` DECIMAL(20,8) DEFAULT 0 COMMENT 'æ€»æ”¯ä»˜é‡‘é¢',

  `settled_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'ç»“ç®—æ—¶é—´',
  `tx_hash` VARCHAR(66) DEFAULT NULL COMMENT 'ç»“ç®—äº¤æ˜“å“ˆå¸Œ',

  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_market_id` (`market_id`),
  KEY `idx_settled_at` (`settled_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ç»“ç®—è¡¨';
```

---

### 10. ç”¨æˆ·ç»“ç®—è¡¨ (user_settlements)

```sql
CREATE TABLE `user_settlements` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `settlement_id` BIGINT UNSIGNED NOT NULL COMMENT 'ç»“ç®—ID',
  `market_id` BIGINT UNSIGNED NOT NULL COMMENT 'å¸‚åœºID',
  `user_address` VARCHAR(42) NOT NULL COMMENT 'ç”¨æˆ·åœ°å€',

  `position` TINYINT UNSIGNED NOT NULL COMMENT 'ä»“ä½: 0-NO 1-YES',
  `shares` DECIMAL(20,8) NOT NULL COMMENT 'æŒæœ‰ä»½é¢',
  `cost` DECIMAL(20,8) NOT NULL COMMENT 'æˆæœ¬',

  `payout` DECIMAL(20,8) DEFAULT 0 COMMENT 'æ”¯ä»˜é‡‘é¢',
  `profit` DECIMAL(20,8) DEFAULT 0 COMMENT 'ç›ˆåˆ©',
  `profit_rate` DECIMAL(10,4) DEFAULT 0 COMMENT 'ç›ˆåˆ©ç‡',

  `claimed` BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦å·²é¢†å–',
  `claim_tx_hash` VARCHAR(66) DEFAULT NULL COMMENT 'é¢†å–äº¤æ˜“å“ˆå¸Œ',
  `claimed_at` TIMESTAMP NULL DEFAULT NULL COMMENT 'é¢†å–æ—¶é—´',

  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',

  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_settlement_user` (`settlement_id`, `user_address`),
  KEY `idx_market_id` (`market_id`),
  KEY `idx_user_address` (`user_address`),
  KEY `idx_claimed` (`claimed`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ç”¨æˆ·ç»“ç®—è¡¨';
```

---

### 11. é€šçŸ¥è¡¨ (notifications)

```sql
CREATE TABLE `notifications` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'é€šçŸ¥ID',
  `user_address` VARCHAR(42) NOT NULL COMMENT 'ç”¨æˆ·åœ°å€',

  `type` TINYINT UNSIGNED NOT NULL COMMENT 'ç±»å‹: 0-ç³»ç»Ÿ 1-äº¤æ˜“ 2-ç»“ç®— 3-ä¸ªäºº',
  `title` VARCHAR(200) NOT NULL COMMENT 'æ ‡é¢˜',
  `content` TEXT NOT NULL COMMENT 'å†…å®¹',

  `related_type` VARCHAR(50) DEFAULT NULL COMMENT 'å…³è”ç±»å‹',
  `related_id` BIGINT UNSIGNED DEFAULT NULL COMMENT 'å…³è”ID',

  `is_read` BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦å·²è¯»',
  `read_at` TIMESTAMP NULL DEFAULT NULL COMMENT 'é˜…è¯»æ—¶é—´',

  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',

  PRIMARY KEY (`id`),
  KEY `idx_user_address` (`user_address`),
  KEY `idx_type` (`type`),
  KEY `idx_is_read` (`is_read`),
  KEY `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='é€šçŸ¥è¡¨';
```

---

### 12. ç³»ç»Ÿé…ç½®è¡¨ (system_configs)

```sql
CREATE TABLE `system_configs` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'é…ç½®ID',
  `config_key` VARCHAR(100) NOT NULL COMMENT 'é…ç½®é”®',
  `config_value` TEXT NOT NULL COMMENT 'é…ç½®å€¼',
  `config_type` VARCHAR(50) DEFAULT 'string' COMMENT 'é…ç½®ç±»å‹: string, number, json, boolean',
  `description` TEXT DEFAULT NULL COMMENT 'æè¿°',
  `is_public` BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦å…¬å¼€',

  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',

  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_config_key` (`config_key`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ç³»ç»Ÿé…ç½®è¡¨';
```

---

### 13. ç®¡ç†å‘˜è¡¨ (admins)

```sql
CREATE TABLE `admins` (
  `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ç®¡ç†å‘˜ID',
  `wallet_address` VARCHAR(42) NOT NULL COMMENT 'é’±åŒ…åœ°å€',
  `username` VARCHAR(50) NOT NULL COMMENT 'ç”¨æˆ·å',
  `role` VARCHAR(50) NOT NULL COMMENT 'è§’è‰²: super_admin, admin, auditor',

  `permissions` JSON DEFAULT NULL COMMENT 'æƒé™åˆ—è¡¨',

  `status` TINYINT UNSIGNED DEFAULT 1 COMMENT 'çŠ¶æ€: 0-ç¦ç”¨ 1-å¯ç”¨',
  `last_login_at` TIMESTAMP NULL DEFAULT NULL COMMENT 'æœ€åç™»å½•æ—¶é—´',

  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',

  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_wallet_address` (`wallet_address`),
  KEY `idx_role` (`role`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ç®¡ç†å‘˜è¡¨';
```

---

## ğŸ“ˆ Redisç¼“å­˜è®¾è®¡

### 1. å¸‚åœºå®æ—¶ä»·æ ¼
```
Key: market:price:{market_id}
Type: Hash
Fields:
  - yes_price: 67
  - no_price: 33
  - volume_24h: 150000
  - updated_at: 1704355200
TTL: 60ç§’
```

### 2. ç”¨æˆ·ä½™é¢ç¼“å­˜
```
Key: wallet:balance:{user_address}
Type: Hash
Fields:
  - usdc_balance: 10000.50
  - token_balance: 5000.00
  - frozen_balance: 500.00
TTL: 300ç§’
```

### 3. æ’è¡Œæ¦œ
```
Key: leaderboard:profit:all
Type: Sorted Set
Score: total_profit
Member: user_address
TTL: 3600ç§’
```

### 4. çƒ­é—¨å¸‚åœº
```
Key: market:hot
Type: List
Value: [market_id1, market_id2, ...]
TTL: 600ç§’
```

### 5. AIé¢„æµ‹ç¼“å­˜
```
Key: ai:prediction:{market_id}
Type: String (JSON)
Value: {prediction_value, confidence, suggests, ...}
TTL: 1800ç§’
```

### 6. ç”¨æˆ·ä¼šè¯
```
Key: session:{token}
Type: String (JSON)
Value: {user_address, expires_at, ...}
TTL: 86400ç§’
```

---

## ğŸ” ç´¢å¼•ä¼˜åŒ–å»ºè®®

### 1. å¤åˆç´¢å¼•
```sql
-- å¸‚åœºæŸ¥è¯¢ä¼˜åŒ–
ALTER TABLE markets ADD INDEX idx_category_status (category, status);
ALTER TABLE markets ADD INDEX idx_status_end_time (status, end_time);

-- è®¢å•æŸ¥è¯¢ä¼˜åŒ–
ALTER TABLE orders ADD INDEX idx_user_status (user_address, status);
ALTER TABLE orders ADD INDEX idx_market_status (market_id, status);

-- äº¤æ˜“è®°å½•æŸ¥è¯¢ä¼˜åŒ–
ALTER TABLE trades ADD INDEX idx_market_created (market_id, created_at);
```

### 2. å…¨æ–‡ç´¢å¼•
```sql
-- å¸‚åœºæœç´¢ä¼˜åŒ–
ALTER TABLE markets ADD FULLTEXT INDEX ft_question (question);
```

---

## ğŸ”„ æ•°æ®åŒæ­¥ç­–ç•¥

### é“¾ä¸Šæ•°æ®åŒæ­¥
1. **äº‹ä»¶ç›‘å¬**: ç›‘å¬æ™ºèƒ½åˆçº¦äº‹ä»¶
2. **å®šæ—¶åŒæ­¥**: æ¯5åˆ†é’ŸåŒæ­¥ä¸€æ¬¡é“¾ä¸Šæ•°æ®
3. **æ•°æ®æ ¡éªŒ**: å®šæœŸæ ¡éªŒé“¾ä¸Šé“¾ä¸‹æ•°æ®ä¸€è‡´æ€§

### ç¼“å­˜æ›´æ–°ç­–ç•¥
1. **å†™å…¥æ—¶æ›´æ–°**: æ•°æ®å˜æ›´æ—¶ç«‹å³æ›´æ–°ç¼“å­˜
2. **å®šæ—¶åˆ·æ–°**: çƒ­ç‚¹æ•°æ®æ¯åˆ†é’Ÿåˆ·æ–°
3. **æ‡’åŠ è½½**: å†·æ•°æ®æŒ‰éœ€åŠ è½½

---

## ğŸ“Š æ•°æ®å¤‡ä»½ç­–ç•¥

### 1. å…¨é‡å¤‡ä»½
- **é¢‘ç‡**: æ¯å¤©å‡Œæ™¨3ç‚¹
- **ä¿ç•™**: æœ€è¿‘30å¤©

### 2. å¢é‡å¤‡ä»½
- **é¢‘ç‡**: æ¯6å°æ—¶
- **ä¿ç•™**: æœ€è¿‘7å¤©

### 3. Binlogå¤‡ä»½
- **å®æ—¶**: å¼€å¯binlog
- **ä¿ç•™**: æœ€è¿‘7å¤©

---

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. åˆ†è¡¨ç­–ç•¥
```sql
-- äº¤æ˜“è®°å½•æŒ‰æœˆåˆ†è¡¨
trades_202401
trades_202402
...

-- é’±åŒ…æµæ°´æŒ‰æœˆåˆ†è¡¨
wallet_transactions_202401
wallet_transactions_202402
...
```

### 2. è¯»å†™åˆ†ç¦»
- ä¸»åº“: å†™æ“ä½œ
- ä»åº“: è¯»æ“ä½œ
- å»¶è¿Ÿç›‘æ§: <1ç§’

### 3. è¿æ¥æ± é…ç½®
```yaml
mysql:
  max_open_conns: 100
  max_idle_conns: 10
  conn_max_lifetime: 3600s
```

---

## ğŸ“ åˆå§‹åŒ–æ•°æ®

### ç³»ç»Ÿé…ç½®åˆå§‹æ•°æ®
```sql
INSERT INTO system_configs (config_key, config_value, config_type, description, is_public) VALUES
('platform_fee_rate', '0.02', 'number', 'å¹³å°æ‰‹ç»­è´¹ç‡', true),
('min_market_duration', '86400', 'number', 'å¸‚åœºæœ€å°æŒç»­æ—¶é—´(ç§’)', true),
('max_market_duration', '31536000', 'number', 'å¸‚åœºæœ€å¤§æŒç»­æ—¶é—´(ç§’)', true),
('min_liquidity', '1000', 'number', 'æœ€å°æµåŠ¨æ€§è¦æ±‚', true),
('ai_service_fee', '10', 'number', 'AIæœåŠ¡è´¹(USDC)', true),
('token_discount_rate', '0.1', 'number', 'ä»£å¸æŠ˜æ‰£ç‡', true);
```


