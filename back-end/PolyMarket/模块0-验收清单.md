# æ¨¡å—0ï¼šé¡¹ç›®åŸºç¡€æ¶æ„æ­å»º - éªŒæ”¶æ¸…å•

## âœ… å®Œæˆæƒ…å†µæ€»è§ˆ

### å·²åˆ›å»ºçš„æ–‡ä»¶

#### é…ç½®æ–‡ä»¶
- [x] `etc/polymarket-api.yaml` - å®Œæ•´çš„é…ç½®æ–‡ä»¶ï¼ˆMySQLã€Redisã€JWTã€ä¸šåŠ¡é…ç½®ï¼‰

#### æ ¸å¿ƒä»£ç 
- [x] `internal/config/config.go` - é…ç½®ç»“æ„ä½“å®šä¹‰
- [x] `internal/model/init.go` - MySQL æ•°æ®åº“åˆå§‹åŒ–
- [x] `internal/model/redis.go` - Redis åˆå§‹åŒ–
- [x] `internal/svc/servicecontext.go` - æœåŠ¡ä¸Šä¸‹æ–‡ï¼ˆå·²é›†æˆæ•°æ®åº“å’Œä¸­é—´ä»¶ï¼‰
- [x] `polymarket.go` - ä¸»å…¥å£æ–‡ä»¶ï¼ˆå«ä¼˜é›…å…³é—­ï¼‰

#### å·¥å…·ç±»
- [x] `internal/utils/response.go` - ç»Ÿä¸€å“åº”æ ¼å¼å’Œé”™è¯¯ç 

#### ä¸­é—´ä»¶
- [x] `internal/middleware/cors_middleware.go` - CORS è·¨åŸŸä¸­é—´ä»¶
- [x] `internal/middleware/log_middleware.go` - æ—¥å¿—ä¸­é—´ä»¶
- [x] `internal/middleware/recover_middleware.go` - å¼‚å¸¸æ¢å¤ä¸­é—´ä»¶

#### å¥åº·æ£€æŸ¥
- [x] `internal/handler/health/health_handler.go` - å¥åº·æ£€æŸ¥ Handler
- [x] `internal/logic/health/health_logic.go` - å¥åº·æ£€æŸ¥ Logic
- [x] `internal/handler/routes.go` - è·¯ç”±æ³¨å†Œï¼ˆå·²æ›´æ–°ï¼‰

#### è„šæœ¬å’Œæ–‡æ¡£
- [x] `scripts/init_db.sql` - æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
- [x] `scripts/install_deps.sh` - Linux/Mac ä¾èµ–å®‰è£…è„šæœ¬
- [x] `scripts/install_deps.bat` - Windows ä¾èµ–å®‰è£…è„šæœ¬
- [x] `README.md` - é¡¹ç›®è¯´æ˜æ–‡æ¡£

---

## ğŸ§ª éªŒæ”¶æµ‹è¯•æ­¥éª¤

### æ­¥éª¤ 1: å®‰è£…ä¾èµ–

**Windows ç”¨æˆ·**:
```bash
cd back-end/PolyMarket
scripts\install_deps.bat
```

**Linux/Mac ç”¨æˆ·**:
```bash
cd back-end/PolyMarket
chmod +x scripts/install_deps.sh
./scripts/install_deps.sh
```

**é¢„æœŸç»“æœ**: æ‰€æœ‰ä¾èµ–åŒ…æˆåŠŸå®‰è£…ï¼Œæ— é”™è¯¯æç¤º

---

### æ­¥éª¤ 2: é…ç½®æ•°æ®åº“

```bash
# åˆ›å»ºæ•°æ®åº“å¹¶åˆå§‹åŒ–è¡¨ç»“æ„
docker exec -i polymarket-mysql mysql -h 127.0.0.1 -u root -proot polymarket < init_db.sql

mysql -u root -p < scripts/init_db.sql

# è¾“å…¥å¯†ç åï¼Œæ£€æŸ¥æ˜¯å¦æˆåŠŸ
mysql -u root -p -e "USE polymarket; SHOW TABLES;"
```

**é¢„æœŸç»“æœ**: 
```
+----------------------+
| Tables_in_polymarket |
+----------------------+
| system_configs       |
| users                |
+----------------------+
```

---

### æ­¥éª¤ 3: ä¿®æ”¹é…ç½®æ–‡ä»¶

ç¼–è¾‘ `etc/polymarket-api.yaml`ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š

```yaml
MySQL:
  Password: your_actual_password  # æ”¹ä¸ºä½ çš„ MySQL å¯†ç 

Redis:
  Password: ""  # å¦‚æœ Redis æœ‰å¯†ç ï¼Œå¡«å†™åœ¨è¿™é‡Œ
```

---

### æ­¥éª¤ 4: å¯åŠ¨æœåŠ¡

```bash
cd back-end/PolyMarket
go run polymarket.go -f etc/polymarket-api.yaml
```

**é¢„æœŸè¾“å‡º**:
```
Starting server at 0.0.0.0:8888...
```

**æ£€æŸ¥ç‚¹**:
- [ ] æœåŠ¡æˆåŠŸå¯åŠ¨ï¼Œæ—  panic
- [ ] æ§åˆ¶å°æ˜¾ç¤º "Starting server at 0.0.0.0:8888..."
- [ ] æ— æ•°æ®åº“è¿æ¥é”™è¯¯
- [ ] æ—  Redis è¿æ¥é”™è¯¯

---

### æ­¥éª¤ 5: æµ‹è¯•å¥åº·æ£€æŸ¥æ¥å£

**æ‰“å¼€æ–°ç»ˆç«¯**ï¼Œæ‰§è¡Œï¼š

```bash
curl http://localhost:8888/api/v1/health
```

**é¢„æœŸå“åº”**:
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "status": "ok",
    "database": "connected",
    "redis": "connected"
  },
  "timestamp": 1704355200
}
```

**æ£€æŸ¥ç‚¹**:
- [ ] HTTP çŠ¶æ€ç ä¸º 200
- [ ] `code` ä¸º 0
- [ ] `database` ä¸º "connected"
- [ ] `redis` ä¸º "connected"

---

### æ­¥éª¤ 6: æµ‹è¯• CORS ä¸­é—´ä»¶
cd D:\IDEA_File\X402AiPolyMarket2\back-end\PolyMarket
go run polymarket.go


```bash
curl -X OPTIONS http://localhost:8888/api/v1/health \
  -H "Origin: http://localhost:3000" \
  -H "Access-Control-Request-Method: GET" \
  -v
  
```
curl.exe -X OPTIONS http://localhost:8888/api/v1/health -H "Origin: http://localhost:3000" -H "Access-Control-Request-Method: GET" -v


curl.exe -X OPTIONS http://localhost:8888/api/v1/ping `
  -H "Origin: http://localhost:3000" `
-H "Access-Control-Request-Method: GET" -v

**é¢„æœŸç»“æœ**:
- [ ] å“åº”å¤´åŒ…å« `Access-Control-Allow-Origin: *`
- [ ] å“åº”å¤´åŒ…å« `Access-Control-Allow-Methods`
- [ ] HTTP çŠ¶æ€ç ä¸º 204

---

### æ­¥éª¤ 7: æµ‹è¯•æ—¥å¿—ä¸­é—´ä»¶

æŸ¥çœ‹æœåŠ¡ç«¯æ§åˆ¶å°è¾“å‡ºï¼Œåº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š

```
[GET] /api/v1/health - Start
[GET] /api/v1/health - Completed in 2.5ms
```

**æ£€æŸ¥ç‚¹**:
- [ ] æ¯ä¸ªè¯·æ±‚éƒ½æœ‰å¼€å§‹æ—¥å¿—
- [ ] æ¯ä¸ªè¯·æ±‚éƒ½æœ‰å®Œæˆæ—¥å¿—å’Œè€—æ—¶

---

### æ­¥éª¤ 8: æµ‹è¯•ä¼˜é›…å…³é—­

åœ¨æœåŠ¡ç«¯æ§åˆ¶å°æŒ‰ `Ctrl+C`

**é¢„æœŸè¾“å‡º**:
```
Shutting down server...
```

**æ£€æŸ¥ç‚¹**:
- [ ] æœåŠ¡æ­£å¸¸å…³é—­
- [ ] æ•°æ®åº“è¿æ¥å·²å…³é—­
- [ ] Redis è¿æ¥å·²å…³é—­
- [ ] æ— é”™è¯¯æ—¥å¿—

---

## ğŸ“Š éªŒæ”¶æ ‡å‡†

### å¿…é¡»é€šè¿‡çš„æ£€æŸ¥é¡¹

- [ ] âœ… é¡¹ç›®ç›®å½•ç»“æ„ç¬¦åˆ go-zero è§„èŒƒ
- [ ] âœ… æ‰€æœ‰ä¾èµ–åŒ…å®‰è£…æˆåŠŸï¼ˆ`go mod tidy` æ— é”™è¯¯ï¼‰
- [ ] âœ… MySQL è¿æ¥æˆåŠŸ
- [ ] âœ… Redis è¿æ¥æˆåŠŸ
- [ ] âœ… é…ç½®æ–‡ä»¶æ”¯æŒå¤šç¯å¢ƒ
- [ ] âœ… ç»Ÿä¸€å“åº”æ ¼å¼æ­£å¸¸å·¥ä½œ
- [ ] âœ… CORS ä¸­é—´ä»¶æ­£å¸¸å·¥ä½œ
- [ ] âœ… æ—¥å¿—ä¸­é—´ä»¶è®°å½•è¯·æ±‚æ—¥å¿—
- [ ] âœ… å¥åº·æ£€æŸ¥æ¥å£è¿”å›æ­£ç¡®çŠ¶æ€
- [ ] âœ… ä¼˜é›…å…³é—­æœºåˆ¶æ­£å¸¸å·¥ä½œ
- [ ] âœ… ä»£ç æ— ç¼–è¯‘é”™è¯¯
- [ ] âœ… ä»£ç æ— è¿è¡Œæ—¶é”™è¯¯

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1: æ•°æ®åº“è¿æ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯**: `failed to connect database`

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ MySQL æ˜¯å¦å¯åŠ¨ï¼š`mysql -u root -p`
2. æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­çš„å¯†ç æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å·²åˆ›å»ºï¼š`SHOW DATABASES;`

### é—®é¢˜ 2: Redis è¿æ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯**: `failed to connect redis`

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ Redis æ˜¯å¦å¯åŠ¨ï¼š`redis-cli ping`
2. æ£€æŸ¥ Redis ç«¯å£æ˜¯å¦æ­£ç¡®ï¼ˆé»˜è®¤ 6379ï¼‰
3. æ£€æŸ¥ Redis å¯†ç é…ç½®

### é—®é¢˜ 3: ç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**: `bind: address already in use`

**è§£å†³æ–¹æ¡ˆ**:
1. ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£å·
2. æˆ–è€…å…³é—­å ç”¨ 8888 ç«¯å£çš„ç¨‹åº

### é—®é¢˜ 4: ä¾èµ–ä¸‹è½½å¤±è´¥

**é”™è¯¯ä¿¡æ¯**: `go get: timeout`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# è®¾ç½® Go ä»£ç†
go env -w GOPROXY=https://goproxy.cn,direct
```

---

## ğŸ‰ éªŒæ”¶é€šè¿‡æ ‡å‡†

å½“ä»¥ä¸Šæ‰€æœ‰æ£€æŸ¥é¡¹éƒ½é€šè¿‡æ—¶ï¼Œæ¨¡å—0éªŒæ”¶é€šè¿‡ï¼

**ä¸‹ä¸€æ­¥**: å¼€å§‹ **æ¨¡å—1ï¼šç”¨æˆ·è®¤è¯ä¸ç®¡ç†æ¨¡å—** çš„å¼€å‘

---

## ğŸ“ å¤‡æ³¨

- æœ¬æ¨¡å—ä¸ºæ‰€æœ‰åç»­æ¨¡å—çš„åŸºç¡€
- ç¡®ä¿æ‰€æœ‰æµ‹è¯•éƒ½é€šè¿‡åå†è¿›å…¥ä¸‹ä¸€æ¨¡å—
- å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒ `README.md` æˆ–æé—®

